{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI API routes and associated logic for querying data from a Supabase database. It includes data models, validation functions, and the main endpoint for executing filtered, ordered, and paginated queries against specified tables.", "external_files": ["../core/config", "../core/logger", "../services/supabase_client"], "external_methods": ["get_settings", "get_logger", "get_supabase_client", "is_supabase_enabled"], "published": ["supabase_query"], "classes": [{"name": "SupabaseFilter", "description": "Represents a filtering criterion on a column with an operator and a value."}, {"name": "SupabaseQueryResponse", "description": "Defines the response schema for Supabase table query results."}], "methods": [{"name": "None _validate_enabled_or_404()", "description": "Checks if Supabase is enabled and properly configured; raises HTTPException if not.", "scope": "", "scopeKind": ""}, {"name": "Any _apply_filters(q: Any, filters: Optional[List[SupabaseFilter]])", "description": "Applies a list of filters to a Supabase query object.", "scope": "", "scopeKind": ""}, {"name": "Any _apply_order(q: Any, order_by: Optional[str], order_dir: Optional[str])", "description": "Applies ordering to a Supabase query.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Any,Dict[str,Any]] _apply_pagination(q: Any, limit: Optional[int], offset: Optional[int])", "description": "Applies limit and offset for pagination to a Supabase query and returns updated query and metadata.", "scope": "", "scopeKind": ""}, {"name": "SupabaseQueryResponse supabase_query( table: str = Query(..., description=\"Target table name\"), order_by: Optional[str] = Query(None, description=\"Column to order by\"), order_dir: Optional[Literal[\"asc\", \"desc\"]] = Query(\"asc\", description=\"Sort direction\"), limit: Optional[int] = Query(50, ge=1, le=1000, description=\"Max rows to return\"), offset: Optional[int] = Query(0, ge=0, description=\"Number of rows to skip\"), filters: Optional[List[SupabaseFilter]] = Body( default=None, description=\"Optional list of filters to apply to the table query.\", ), )", "description": "FastAPI endpoint to execute a filtered, ordered, and paginated query on a specified Supabase table.", "scope": "", "scopeKind": ""}], "calls": ["get_supabase_client()", "get_settings()", "get_logger(__name__)", "is_supabase_enabled()"], "search-terms": ["supabase", "supabase_query", "SupabaseFilter", "SupabaseQueryResponse", "FastAPI Supabase router", "supabase table query", "query parameters", "Supabase client"], "state": 2, "file_id": 21, "knowledge_revision": 85, "git_revision": "cd3cb753935cd00a804626f995db1c0df32b9b54", "revision_history": [{"72": ""}, {"85": "cd3cb753935cd00a804626f995db1c0df32b9b54"}], "ctags": [{"_type": "tag", "name": "SupabaseFilter", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^class SupabaseFilter(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SupabaseQueryResponse", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^class SupabaseQueryResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_apply_filters", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^def _apply_filters(q: Any, filters: Optional[List[SupabaseFilter]]) -> Any:$/", "language": "Python", "typeref": "typename:Any", "kind": "function", "signature": "(q: Any, filters: Optional[List[SupabaseFilter]])"}, {"_type": "tag", "name": "_apply_order", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^def _apply_order(q: Any, order_by: Optional[str], order_dir: Optional[str]) -> Any:$/", "language": "Python", "typeref": "typename:Any", "kind": "function", "signature": "(q: Any, order_by: Optional[str], order_dir: Optional[str])"}, {"_type": "tag", "name": "_apply_pagination", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^def _apply_pagination(q: Any, limit: Optional[int], offset: Optional[int]) -> Tuple[Any, Dict[st/", "language": "Python", "typeref": "typename:Tuple[Any,Dict[str,Any]]", "kind": "function", "signature": "(q: Any, limit: Optional[int], offset: Optional[int])"}, {"_type": "tag", "name": "_validate_enabled_or_404", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^def _validate_enabled_or_404() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "column", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^    column: str = Field(..., description=\"Column name to filter on\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SupabaseFilter", "scopeKind": "class"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^    items: List[Dict[str, Any]] = Field(default_factory=list, description=\"Result rows\")$/", "language": "Python", "typeref": "typename:List[Dict[str, Any]]", "kind": "variable", "scope": "SupabaseQueryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^logger = get_logger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "meta", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^    meta: Dict[str, Any] = Field($/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "SupabaseQueryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "op", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^    op: Literal[\"eq\", \"neq\", \"lt\", \"lte\", \"gt\", \"gte\", \"ilike\"] = Field($/", "language": "Python", "typeref": "typename:Literal[\"eq\", \"neq\", \"lt\", \"lte\", \"gt\", \"gte\", \"ilike\"]", "kind": "variable", "scope": "SupabaseFilter", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^router = APIRouter(prefix=\"\\/supabase\", tags=[\"Supabase\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "supabase_query", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^async def supabase_query($/", "language": "Python", "typeref": "typename:SupabaseQueryResponse", "kind": "function", "signature": "( table: str = Query(..., description=\"Target table name\"), order_by: Optional[str] = Query(None, description=\"Column to order by\"), order_dir: Optional[Literal[\"asc\", \"desc\"]] = Query(\"asc\", description=\"Sort direction\"), limit: Optional[int] = Query(50, ge=1, le=1000, description=\"Max rows to return\"), offset: Optional[int] = Query(0, ge=0, description=\"Number of rows to skip\"), filters: Optional[List[SupabaseFilter]] = Body( default=None, description=\"Optional list of filters to apply to the table query.\", ), )"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/supabase.py", "pattern": "/^    value: Any = Field(..., description=\"Value to compare against\")$/", "language": "Python", "typeref": "typename:Any", "kind": "variable", "scope": "SupabaseFilter", "scopeKind": "class"}], "hash": "ee73f6231a2fb6db0600401eb984e001", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/routers/supabase.py", "fields": [{"name": "str column", "scope": "SupabaseFilter", "scopeKind": "class", "description": "unavailable"}, {"name": "List[Dict[str, Any]] items", "scope": "SupabaseQueryResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "logger = get_logger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, Any] meta", "scope": "SupabaseQueryResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Literal[\"eq\", \"neq\", \"lt\", \"lte\", \"gt\", \"gte\", \"ilike\"] op", "scope": "SupabaseFilter", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/supabase\", tags=[\"Supabase\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Any value", "scope": "SupabaseFilter", "scopeKind": "class", "description": "unavailable"}]}