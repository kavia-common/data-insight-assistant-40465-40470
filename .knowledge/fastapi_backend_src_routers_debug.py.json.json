{"is_source_file": true, "format": "Python", "description": "This file defines a FastAPI router '/debug' with an endpoint '/config' that provides diagnostic information about the application's database configuration environment variables, URLs, and settings. It includes functions for detecting the database connection source, redacting URLs, and parsing URL parameters, as well as a Pydantic model for returning structured diagnostic info.", "external_files": ["../core/config", "../core/logger"], "external_methods": ["get_settings", "get_logger"], "published": ["debug_config"], "classes": [{"name": "DBConfigDebug", "description": "Pydantic model representing the effective database configuration info for diagnostics, including fields for source, host, port, database, sslmode, driver, redacted URL, environment variable presence flags, and optional notes."}], "methods": [{"name": "str _detect_db_source()", "description": "Determines which database configuration source is in use based on environment variables and settings, prioritizing DATABASE_URL, then SUPABASE_DB_CONNECTION_STRING, then discrete env vars.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _redact_env_url(url: Optional[str])", "description": "Redacts sensitive parts (such as user credentials) from a database URL for logging purposes.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _parse_effective_params_from_url(url: Optional[str])", "description": "Parses the database URL to extract host, port, database, driver, and SSL mode presence, also providing a redacted version of the URL.", "scope": "", "scopeKind": ""}, {"name": "DBConfigDebug debug_config()", "description": "FastAPI endpoint handler that returns the current effective database configuration details, including environment variable presence flags, source, host, port, database, SSL mode, driver, and redacted URL. It runs a pure env and config parse without any database connection.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _env_presence()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["get_settings", "get_logger", "_detect_db_source", "_parse_effective_params_from_url", "_redact_env_url", "debug_config"], "search-terms": ["debug", "DB configuration", "database URL", "environment variables", "FastAPI router", "diagnostics"], "state": 2, "file_id": 28, "knowledge_revision": 159, "git_revision": "b71603ac8aa245277a7270ef7c15b5979c0117b8", "revision_history": [{"154": ""}, {"159": "b71603ac8aa245277a7270ef7c15b5979c0117b8"}], "ctags": [{"_type": "tag", "name": "DBConfigDebug", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^class DBConfigDebug(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NO_DB_MODE", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^NO_DB_MODE = True$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_detect_db_source", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^def _detect_db_source() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_env_presence", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^def _env_presence() -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_parse_effective_params_from_url", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^def _parse_effective_params_from_url(url: Optional[str]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(url: Optional[str])"}, {"_type": "tag", "name": "_redact_env_url", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^def _redact_env_url(url: Optional[str]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(url: Optional[str])"}, {"_type": "tag", "name": "database", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    database: Optional[str] = Field(None, description=\"Effective database name\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "debug_config", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^def debug_config() -> DBConfigDebug:$/", "language": "Python", "typeref": "typename:DBConfigDebug", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "driver", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    driver: str = Field(..., description=\"Resolved SQLAlchemy driver (e.g., psycopg2)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "env_presence", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    env_presence: Dict[str, Any] = Field(..., description=\"Presence flags of env vars (.env load/", "language": "Python", "typeref": "typename:Dict[str, Any]", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "host", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    host: Optional[str] = Field(None, description=\"Effective database host\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^logger = get_logger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "notes", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    notes: Optional[str] = Field(None, description=\"Additional notes or warnings about precedenc/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "port", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    port: Optional[str] = Field(None, description=\"Effective database port\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "redacted_url", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    redacted_url: Optional[str] = Field(None, description=\"Redacted connection URL suitable for /", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^router = APIRouter(prefix=\"\\/debug\", tags=[\"Health\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "source", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    source: str = Field(..., description=\"Which configuration source is active (DATABASE_URL, SU/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}, {"_type": "tag", "name": "sslmode_present", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/debug.py", "pattern": "/^    sslmode_present: bool = Field(..., description=\"Whether sslmode is present on the connection/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "DBConfigDebug", "scopeKind": "class"}], "hash": "39e126e9ca6e7e709719157d1682ac9b", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/routers/debug.py", "fields": [{"name": "NO_DB_MODE = True", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] database", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "str driver", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, Any] env_presence", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] host", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "logger = get_logger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] notes", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] port", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] redacted_url", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/debug\", tags=[\"Health\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str source", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}, {"name": "bool sslmode_present", "scope": "DBConfigDebug", "scopeKind": "class", "description": "unavailable"}]}