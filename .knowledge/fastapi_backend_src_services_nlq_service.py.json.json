{"is_source_file": true, "format": "Python", "description": "This file defines a Natural Language Query (NLQ) service that interprets natural language inputs to generate MongoDB-style query filters, projections, sorting, and pagination options. It includes functions for parsing date ranges, comparisons, equality, categories, contains expressions, and assembling a full query dictionary. The module emphasizes deterministic, rule-based parsing without external dependencies.", "external_files": [], "external_methods": [], "published": ["parse_nlq_to_query"], "classes": [], "methods": [{"name": "Dict[str,Any] parse_nlq_to_query(nlq: str)", "description": "Main function to parse natural language queries into structured MongoDB query components.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict[str,Any]] _apply_date_range(tokens: str, now: datetime)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _collect_filters(phrase: str, now: datetime)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,int]] _ensure_projection(fields: Optional[List[str]])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _merge_and(dst: Dict[str, Any], src: Dict[str, Any])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "datetime _now_utc()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_category(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_comparison(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_contains(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_equality(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[List[str]] _parse_fields(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Tuple[Optional[int],Optional[int]] _parse_limit_offset(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] _parse_list_csv(text: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Union[int,float,str] _parse_number(val: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Tuple[str,int]] _parse_sort(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["_collect_filters", "_parse_sort", "_parse_limit_offset", "_parse_fields", "_ensure_projection", "_merge_and", "_apply_date_range", "_parse_number", "_parse_list_csv", "_parse_comparison", "_parse_equality", "_parse_category", "_parse_contains", "_now_utc"], "search-terms": ["NLQ service", "MongoDB style filters", "rule-based natural language parsing", "date range parsing", "deterministic query generation", "natural language to MongoDB query", "no external dependencies"], "state": 2, "file_id": 12, "knowledge_revision": 133, "git_revision": "48a66c85da4fa1becca41ec960bc7ae7315bca28", "revision_history": [{"29": ""}, {"47": "de8dac7f2dbfa13add05824461f11be20f7998ad"}, {"133": "48a66c85da4fa1becca41ec960bc7ae7315bca28"}], "ctags": [{"_type": "tag", "name": "_apply_date_range", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _apply_date_range(tokens: str, now: datetime) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(tokens: str, now: datetime)"}, {"_type": "tag", "name": "_collect_filters", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _collect_filters(phrase: str, now: datetime) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(phrase: str, now: datetime)"}, {"_type": "tag", "name": "_ensure_projection", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _ensure_projection(fields: Optional[List[str]]) -> Optional[Dict[str, int]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,int]]", "kind": "function", "signature": "(fields: Optional[List[str]])"}, {"_type": "tag", "name": "_merge_and", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _merge_and(dst: Dict[str, Any], src: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(dst: Dict[str, Any], src: Dict[str, Any])"}, {"_type": "tag", "name": "_now_utc", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _now_utc() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_parse_category", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_category(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_comparison", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_comparison(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_contains", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_contains(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_equality", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_equality(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_fields", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_fields(phrase: str) -> Optional[List[str]]:$/", "language": "Python", "typeref": "typename:Optional[List[str]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_limit_offset", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_limit_offset(phrase: str) -> Tuple[Optional[int], Optional[int]]:$/", "language": "Python", "typeref": "typename:Tuple[Optional[int],Optional[int]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_list_csv", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_list_csv(text: str) -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "(text: str)"}, {"_type": "tag", "name": "_parse_number", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_number(val: str) -> Union[int, float, str]:$/", "language": "Python", "typeref": "typename:Union[int,float,str]", "kind": "function", "signature": "(val: str)"}, {"_type": "tag", "name": "_parse_sort", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_sort(phrase: str) -> Optional[Tuple[str, int]]:$/", "language": "Python", "typeref": "typename:Optional[Tuple[str,int]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "parse_nlq_to_query", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def parse_nlq_to_query(nlq: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(nlq: str)"}], "hash": "883388bd8eaea900ad7a4341a6a07c4c", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/services/nlq_service.py"}