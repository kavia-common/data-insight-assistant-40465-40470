{"is_source_file": true, "format": "Python", "description": "This Python source file implements a deterministic Natural Language Query (NLQ) service that parses simple natural language patterns into MongoDB query components, including filters, projections, sorting, limits, and offsets.", "external_files": [], "external_methods": ["re.match", "re.search", "re.escape", "datetime", "timedelta", "timezone", "datetime.now"], "published": ["parse_nlq_to_query"], "classes": [], "methods": [{"name": "Dict[str,Any] parse_nlq_to_query(nlq: str)", "description": "Main function translating natural language queries into MongoDB query specifications.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict[str,Any]] _apply_date_range(tokens: str, now: datetime)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _collect_filters(phrase: str, now: datetime)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,int]] _ensure_projection(fields: Optional[List[str]])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _merge_and(dst: Dict[str, Any], src: Dict[str, Any])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "datetime _now_utc()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_category(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_comparison(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_contains(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str,Any]] _parse_equality(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[List[str]] _parse_fields(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Tuple[Optional[int],Optional[int]] _parse_limit_offset(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] _parse_list_csv(text: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Union[int,float,str] _parse_number(val: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Tuple[str,int]] _parse_sort(phrase: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["re.match", "re.search", "re.escape", "_now_utc", "_apply_date_range", "_parse_sort", "_parse_limit_offset", "_parse_fields", "_ensure_projection", "_collect_filters", "_merge_and", "_parse_comparison", "_parse_equality", "_parse_category", "_parse_contains"], "search-terms": ["nlq_service", "Natural Language Query", "deterministic parsing", "MongoDB filter", "rule-based", "date ranges", "comparison operators", "category in", "contains", "sort by", "limit N", "fields selection"], "state": 2, "file_id": 12, "knowledge_revision": 47, "git_revision": "de8dac7f2dbfa13add05824461f11be20f7998ad", "revision_history": [{"29": ""}, {"47": "de8dac7f2dbfa13add05824461f11be20f7998ad"}], "ctags": [{"_type": "tag", "name": "_apply_date_range", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _apply_date_range(tokens: str, now: datetime) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(tokens: str, now: datetime)"}, {"_type": "tag", "name": "_collect_filters", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _collect_filters(phrase: str, now: datetime) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(phrase: str, now: datetime)"}, {"_type": "tag", "name": "_ensure_projection", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _ensure_projection(fields: Optional[List[str]]) -> Optional[Dict[str, int]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,int]]", "kind": "function", "signature": "(fields: Optional[List[str]])"}, {"_type": "tag", "name": "_merge_and", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _merge_and(dst: Dict[str, Any], src: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(dst: Dict[str, Any], src: Dict[str, Any])"}, {"_type": "tag", "name": "_now_utc", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _now_utc() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_parse_category", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_category(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_comparison", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_comparison(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_contains", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_contains(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_equality", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_equality(phrase: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_fields", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_fields(phrase: str) -> Optional[List[str]]:$/", "language": "Python", "typeref": "typename:Optional[List[str]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_limit_offset", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_limit_offset(phrase: str) -> Tuple[Optional[int], Optional[int]]:$/", "language": "Python", "typeref": "typename:Tuple[Optional[int],Optional[int]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "_parse_list_csv", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_list_csv(text: str) -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "(text: str)"}, {"_type": "tag", "name": "_parse_number", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_number(val: str) -> Union[int, float, str]:$/", "language": "Python", "typeref": "typename:Union[int,float,str]", "kind": "function", "signature": "(val: str)"}, {"_type": "tag", "name": "_parse_sort", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def _parse_sort(phrase: str) -> Optional[Tuple[str, int]]:$/", "language": "Python", "typeref": "typename:Optional[Tuple[str,int]]", "kind": "function", "signature": "(phrase: str)"}, {"_type": "tag", "name": "parse_nlq_to_query", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/services/nlq_service.py", "pattern": "/^def parse_nlq_to_query(nlq: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(nlq: str)"}], "hash": "edf77d0fcade499482c249ce795bb096", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/services/nlq_service.py"}