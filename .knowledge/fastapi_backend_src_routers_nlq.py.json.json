{"is_source_file": true, "format": "Python", "description": "This file defines a FastAPI router for handling Natural Language Queries (NLQ). It includes endpoint definitions, helper functions for query parameters, filtering, and sorting, and the main API handler 'execute_nlq' that processes incoming requests, parses NLQ queries, interacts with the database using SQLAlchemy, and returns paginated results.", "external_files": ["../core/config", "../db/sqlalchemy", "../models/schemas", "../services/nlq_service", "../models/sql_models"], "external_methods": ["get_settings", "get_db", "parse_nlq_to_query"], "published": ["execute_nlq"], "classes": [], "methods": [{"name": "Tuple[int,int] _coalesce_limit_offset(req: NLQRequest, parsed: Dict[str, Any])", "description": "Determines limit and offset values for pagination, using request parameters or defaults.", "scope": "", "scopeKind": ""}, {"name": "_apply_filter(stmt, f: Dict[str, Any])", "description": "Builds SQLAlchemy filter clauses based on provided filter dictionary, supporting equality checks on 'data.*' JSON fields.", "scope": "", "scopeKind": ""}, {"name": "_apply_sort(stmt, sort_spec: Optional[List[List[Any]]], req: NLQRequest)", "description": "Applies sorting to a SQLAlchemy query based on provided sort specifications and request parameters.", "scope": "", "scopeKind": ""}, {"name": "NLQResponse execute_nlq(req: NLQRequest, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["get_settings", "get_db", "parse_nlq_to_query", "select", "func.count", "text", "db.execute", "nlq_response", "raise HTTPException", "raise", "db.execute", "db.execute"], "search-terms": ["FastAPI NLQ router", "NLQ endpoint", "query parsing", "dynamic filtering", "JSON data filtering", "pagination", "SQLAlchemy query builder"], "state": 2, "file_id": 16, "knowledge_revision": 114, "git_revision": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08", "revision_history": [{"36": "de8dac7f2dbfa13add05824461f11be20f7998ad"}, {"48": "48a66c85da4fa1becca41ec960bc7ae7315bca28"}, {"90": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08"}, {"102": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08"}, {"108": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08"}, {"114": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08"}], "ctags": [{"_type": "tag", "name": "_apply_filter", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _apply_filter(stmt, f: Dict[str, Any]):$/", "language": "Python", "kind": "function", "signature": "(stmt, f: Dict[str, Any])"}, {"_type": "tag", "name": "_apply_sort", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _apply_sort(stmt, sort_spec: Optional[List[List[Any]]], req: NLQRequest):$/", "language": "Python", "kind": "function", "signature": "(stmt, sort_spec: Optional[List[List[Any]]], req: NLQRequest)"}, {"_type": "tag", "name": "_coalesce_limit_offset", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_limit_offset(req: NLQRequest, parsed: Dict[str, Any]) -> Tuple[int, int]:$/", "language": "Python", "typeref": "typename:Tuple[int,int]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "execute_nlq", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def execute_nlq(req: NLQRequest, db: Session = Depends(get_db)) -> NLQResponse:$/", "language": "Python", "typeref": "typename:NLQResponse", "kind": "function", "signature": "(req: NLQRequest, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^router = APIRouter(prefix=\"\\/nlq\", tags=[\"NLQ\"])$/", "language": "Python", "kind": "variable"}], "hash": "4fb7d8914f7a4ec8b2bde7b4b1239271", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/routers/nlq.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/nlq\", tags=[\"NLQ\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}