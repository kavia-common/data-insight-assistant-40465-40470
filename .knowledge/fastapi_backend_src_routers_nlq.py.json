{"is_source_file": true, "format": "Python", "description": "This file defines an API router for handling natural language queries (NLQ) in a FastAPI application. It includes endpoint definition, request handling, interaction with MongoDB, parsing of natural language into database queries, and response serialization.", "external_files": ["../core/config", "../db/mongo", "../models/schemas", "../services/nlq_service"], "external_methods": ["get_settings", "get_collection", "NLQRequest", "NLQResponse", "PaginationMeta", "serialize_object_id", "parse_nlq_to_query"], "published": ["execute_nlq"], "classes": [], "methods": [{"name": "_get_collection_or_503(name: Optional[str])", "description": "Internal function to retrieve a MongoDB collection by name, raises HTTP 503 if unavailable.", "scope": "", "scopeKind": ""}, {"name": "Tuple[int,int] _coalesce_limit_offset(req: NLQRequest, parsed: Dict[str, Any])", "description": "Combine limit and offset parameters from request and parsed data with defaults.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict[str,int]] _coalesce_projection(req: NLQRequest, parsed: Dict[str, Any])", "description": "Determine MongoDB projection based on request and parsed parameters.", "scope": "", "scopeKind": ""}, {"name": "Optional[List[Tuple[str,int]]] _coalesce_sort(req: NLQRequest, parsed: Dict[str, Any])", "description": "Build MongoDB sort specification from parsed data and request parameters.", "scope": "", "scopeKind": ""}, {"name": "NLQResponse execute_nlq(req: NLQRequest)", "description": "Main API endpoint to process a natural language query, interact with MongoDB, and return results.", "scope": "", "scopeKind": ""}], "calls": ["get_settings", "get_collection", "parse_nlq_to_query", "coll.count_documents", "coll.find", "cursor.sort", "cursor.skip", "cursor.limit", "cursor.to_list", "serialize_object_id"], "search-terms": ["NLQ", "NaturalLanguageQuery", "MongoDB query", "/nlq", "APIRouter", "parse_nlq_to_query", "FastAPI route"], "state": 2, "file_id": 16, "knowledge_revision": 90, "git_revision": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08", "revision_history": [{"36": "de8dac7f2dbfa13add05824461f11be20f7998ad"}, {"48": "48a66c85da4fa1becca41ec960bc7ae7315bca28"}, {"90": "525a4ee3142b3f0e14bd32ed9d48e3f89e0b6a08"}], "ctags": [{"_type": "tag", "name": "_coalesce_limit_offset", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_limit_offset(req: NLQRequest, parsed: Dict[str, Any]) -> Tuple[int, int]:$/", "language": "Python", "typeref": "typename:Tuple[int,int]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "_coalesce_projection", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_projection(req: NLQRequest, parsed: Dict[str, Any]) -> Optional[Dict[str, int]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,int]]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "_coalesce_sort", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_sort(req: NLQRequest, parsed: Dict[str, Any]) -> Optional[List[Tuple[str, int]]]:$/", "language": "Python", "typeref": "typename:Optional[List[Tuple[str,int]]]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "_get_collection_or_503", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _get_collection_or_503(name: Optional[str]):$/", "language": "Python", "kind": "function", "signature": "(name: Optional[str])"}, {"_type": "tag", "name": "execute_nlq", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^async def execute_nlq(req: NLQRequest) -> NLQResponse:$/", "language": "Python", "typeref": "typename:NLQResponse", "kind": "function", "signature": "(req: NLQRequest)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^router = APIRouter(prefix=\"\\/nlq\", tags=[\"NLQ\"])$/", "language": "Python", "kind": "variable"}], "hash": "79fb5150896a405d00ffd93fef7b3d3e", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/routers/nlq.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/nlq\", tags=[\"NLQ\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}