{"is_source_file": true, "format": "Python", "description": "This source file defines FastAPI routes and functions related to Natural Language Query (NLQ) processing. It includes the API endpoint for executing NLQs by parsing natural language input into MongoDB queries, handling pagination, sorting, and projections, and interacting with the MongoDB collection. The file also contains helper functions for collection retrieval and request parameter coalescing.", "external_files": ["../core/config", "../db/mongo", "../models/schemas", "../services/nlq_service"], "external_methods": ["get_settings", "get_collection", "parse_nlq_to_query", "serialize_object_id"], "published": ["execute_nlq"], "classes": [], "methods": [{"name": "_get_collection_or_503(name: Optional[str])", "description": "Retrieves a MongoDB collection by name or raises an HTTP 503 error if unavailable.", "scope": "", "scopeKind": ""}, {"name": "Tuple[int,int] _coalesce_limit_offset(req: NLQRequest, parsed: Dict[str, Any])", "description": "Determines the limit and offset values for pagination, combining request parameters and parsed query defaults.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict[str,int]] _coalesce_projection(req: NLQRequest, parsed: Dict[str, Any])", "description": "Builds the projection dictionary for MongoDB query, based on request parameters or parsed query.", "scope": "", "scopeKind": ""}, {"name": "Optional[List[Tuple[str,int]]] _coalesce_sort(req: NLQRequest, parsed: Dict[str, Any])", "description": "Constructs the sort specification for MongoDB query, based on request parameters or parsed query.", "scope": "", "scopeKind": ""}, {"name": "NLQResponse execute_nlq(req: NLQRequest)", "description": "Main API endpoint to process NLQ requests, execute the derived MongoDB query, and return paginated results.", "scope": "", "scopeKind": ""}], "calls": ["get_settings", "get_collection", "parse_nlq_to_query", "serialize_object_id", "coll.count_documents", "coll.find"], "search-terms": ["NLQ", "Natural Language Query", "MongoDB", "FastAPI", "nlq_service", "query", "pagination", "sorting", "projection"], "state": 2, "file_id": 16, "knowledge_revision": 48, "git_revision": "48a66c85da4fa1becca41ec960bc7ae7315bca28", "revision_history": [{"36": "de8dac7f2dbfa13add05824461f11be20f7998ad"}, {"48": "48a66c85da4fa1becca41ec960bc7ae7315bca28"}], "ctags": [{"_type": "tag", "name": "_coalesce_limit_offset", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_limit_offset(req: NLQRequest, parsed: Dict[str, Any]) -> Tuple[int, int]:$/", "language": "Python", "typeref": "typename:Tuple[int,int]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "_coalesce_projection", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_projection(req: NLQRequest, parsed: Dict[str, Any]) -> Optional[Dict[str, int]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,int]]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "_coalesce_sort", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _coalesce_sort(req: NLQRequest, parsed: Dict[str, Any]) -> Optional[List[Tuple[str, int]]]:$/", "language": "Python", "typeref": "typename:Optional[List[Tuple[str,int]]]", "kind": "function", "signature": "(req: NLQRequest, parsed: Dict[str, Any])"}, {"_type": "tag", "name": "_get_collection_or_503", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^def _get_collection_or_503(name: Optional[str]):$/", "language": "Python", "kind": "function", "signature": "(name: Optional[str])"}, {"_type": "tag", "name": "execute_nlq", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^async def execute_nlq(req: NLQRequest) -> NLQResponse:$/", "language": "Python", "typeref": "typename:NLQResponse", "kind": "function", "signature": "(req: NLQRequest)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/data-insight-assistant-40465-40470/fastapi_backend/src/routers/nlq.py", "pattern": "/^router = APIRouter(prefix=\"\\/nlq\", tags=[\"NLQ\"])$/", "language": "Python", "kind": "variable"}], "hash": "4d844325a7a771f1e1910a89476e296d", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/routers/nlq.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/nlq\", tags=[\"NLQ\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}